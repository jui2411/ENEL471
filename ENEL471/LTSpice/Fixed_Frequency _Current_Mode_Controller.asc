Version 4
SHEET 1 6948 2260
WIRE 5824 -336 5280 -336
WIRE 5952 -336 5824 -336
WIRE 6032 -336 5952 -336
WIRE 6080 -336 6032 -336
WIRE 6416 -336 6080 -336
WIRE 5824 -304 5824 -336
WIRE 5952 -288 5952 -336
WIRE 6032 -288 6032 -336
WIRE 6416 -240 6416 -336
WIRE 5824 -176 5824 -224
WIRE 5952 -176 5952 -224
WIRE 5952 -176 5824 -176
WIRE 6032 -176 6032 -224
WIRE 6032 -176 5952 -176
WIRE -1808 -160 -1968 -160
WIRE 2896 -128 2896 -224
WIRE 6416 -128 6416 -160
WIRE -1808 -112 -1808 -160
WIRE -48 -96 -96 -96
WIRE 96 -96 32 -96
WIRE 5280 -80 5232 -80
WIRE 5376 -80 5280 -80
WIRE 5440 -80 5376 -80
WIRE 5568 -80 5504 -80
WIRE 5600 -80 5568 -80
WIRE 5744 -80 5664 -80
WIRE 4368 -64 4368 -176
WIRE -2384 -32 -2384 -64
WIRE 3360 -32 3056 -32
WIRE 3440 -32 3360 -32
WIRE 5280 -32 5280 -80
WIRE 6080 -32 6080 -336
WIRE -1376 -16 -1440 -16
WIRE 5568 -16 5568 -80
WIRE -1184 0 -1312 0
WIRE -1104 0 -1184 0
WIRE 2736 0 2528 0
WIRE -1808 16 -1808 -32
WIRE -1376 16 -1808 16
WIRE 6416 16 6416 -48
WIRE -432 32 -528 32
WIRE -320 32 -432 32
WIRE -96 32 -96 -96
WIRE -96 32 -240 32
WIRE -48 32 -96 32
WIRE -1808 48 -1808 16
WIRE 96 48 96 -96
WIRE 96 48 16 48
WIRE 272 48 96 48
WIRE 4368 48 4368 16
WIRE 4448 48 4368 48
WIRE 4624 48 4528 48
WIRE 5376 48 5376 -80
WIRE 5440 48 5376 48
WIRE 5872 48 5696 48
WIRE 5984 48 5952 48
WIRE 6032 48 5984 48
WIRE -48 64 -80 64
WIRE 2624 64 2608 64
WIRE 2736 64 2704 64
WIRE -2384 80 -2384 48
WIRE -2272 80 -2384 80
WIRE 4368 80 4368 48
WIRE -2272 96 -2272 80
WIRE 3120 96 3056 96
WIRE 3152 96 3120 96
WIRE 3280 96 3232 96
WIRE 3488 96 3280 96
WIRE -1440 128 -1440 -16
WIRE -1344 128 -1440 128
WIRE -1184 128 -1184 0
WIRE -1184 128 -1264 128
WIRE 2608 128 2608 64
WIRE 2736 128 2608 128
WIRE 4304 128 4160 128
WIRE 5376 128 5376 48
WIRE 5440 128 5376 128
WIRE 5744 128 5744 -80
WIRE 5744 128 5696 128
WIRE 5984 128 5744 128
WIRE 6080 128 6080 64
WIRE 6080 128 5984 128
WIRE 6416 128 6416 96
WIRE 6416 128 6080 128
WIRE -320 144 -528 144
WIRE -80 144 -80 64
WIRE -80 144 -240 144
WIRE 3120 160 3120 96
WIRE 3280 160 3280 96
WIRE 3360 160 3360 -32
WIRE -1808 176 -1808 128
WIRE -1440 176 -1440 128
WIRE 5440 208 5232 208
WIRE 5808 208 5696 208
WIRE 6080 208 6080 128
WIRE -2384 224 -2384 80
WIRE -1968 272 -1968 -160
WIRE -1808 272 -1808 256
WIRE -1808 272 -1968 272
WIRE -1440 272 -1440 256
WIRE -80 288 -80 224
WIRE 2896 288 2896 192
WIRE 3120 288 3120 224
WIRE 3120 288 2896 288
WIRE 3280 288 3280 240
WIRE 3280 288 3120 288
WIRE 3360 288 3360 240
WIRE 3360 288 3280 288
WIRE 5808 288 5808 208
WIRE 5888 288 5808 288
WIRE 6000 288 5968 288
WIRE 6032 288 6000 288
WIRE -1808 304 -1808 272
WIRE 4368 320 4368 176
WIRE 5280 320 5280 48
WIRE 5376 320 5376 192
WIRE 5376 320 5280 320
WIRE 5568 320 5568 272
WIRE 5568 320 5376 320
WIRE 3488 336 3488 96
WIRE 3488 336 2528 336
WIRE 5568 352 5568 320
WIRE 2608 384 2608 128
WIRE 3440 384 2608 384
WIRE 6000 384 6000 368
WIRE 6080 384 6080 304
WIRE 6080 384 6000 384
WIRE 6080 400 6080 384
WIRE 2608 432 2608 384
WIRE 2608 544 2608 496
WIRE 2896 544 2896 288
WIRE 2896 544 2608 544
WIRE 2608 576 2608 544
WIRE 32 944 -16 944
WIRE 192 944 112 944
WIRE 3008 1040 2960 1040
WIRE 3168 1040 3088 1040
WIRE -16 1072 -16 944
WIRE -16 1072 -448 1072
WIRE 48 1072 -16 1072
WIRE 192 1088 192 944
WIRE 192 1088 112 1088
WIRE 304 1088 192 1088
WIRE -448 1104 -448 1072
WIRE 48 1104 -16 1104
WIRE 2960 1168 2960 1040
WIRE 2960 1168 2624 1168
WIRE 3024 1168 2960 1168
WIRE 3168 1184 3168 1040
WIRE 3168 1184 3088 1184
WIRE 3280 1184 3168 1184
WIRE 2624 1200 2624 1168
WIRE 3024 1200 2928 1200
WIRE -448 1312 -448 1184
WIRE 2624 1376 2624 1280
WIRE 3568 1888 3504 1888
WIRE 3808 1904 3632 1904
WIRE 3888 1904 3808 1904
WIRE 5888 1904 5696 1904
WIRE 3280 1920 3072 1920
WIRE 3456 1920 3360 1920
WIRE 3568 1920 3536 1920
WIRE 4688 1920 4656 1920
WIRE 4864 1920 4768 1920
WIRE 4992 1920 4864 1920
WIRE 3456 1984 3456 1920
WIRE 3536 1984 3536 1920
WIRE 3536 1984 3456 1984
WIRE 4864 1984 4864 1920
WIRE 5888 1984 5888 1904
WIRE 3504 2000 3504 1888
WIRE 3680 2000 3504 2000
WIRE 3808 2000 3808 1904
WIRE 3808 2000 3760 2000
WIRE 3280 2032 3072 2032
WIRE 3456 2032 3456 1984
WIRE 3456 2032 3360 2032
WIRE 4864 2096 4864 2048
WIRE 3504 2112 3504 2080
WIRE 3504 2112 3312 2112
WIRE 3312 2144 3312 2112
FLAG -80 288 0
FLAG -16 16 VCC
FLAG -16 80 VEE
FLAG -2272 96 0
FLAG -2384 -64 VCC
FLAG -2384 224 VEE
FLAG -432 32 VIN
FLAG 2608 576 0
FLAG 4368 320 0
FLAG 2624 1376 0
FLAG 3056 1152 VCC
FLAG 3056 1216 VEE
FLAG 3312 2144 0
FLAG 3600 1872 VCC
FLAG 3600 1936 VEE
FLAG 6080 400 0
FLAG 5568 352 0
FLAG 5824 -176 0
FLAG 5232 -80 5Vs
IOPIN 5232 -80 Out
FLAG 5696 1904 V_LEM
IOPIN 5696 1904 Out
FLAG 4656 1920 V_LEM
IOPIN 4656 1920 In
FLAG 5888 2064 0
FLAG 5232 208 MOTOR_IN
IOPIN 5232 208 In
FLAG 4000 800 5Vs
IOPIN 4000 800 Out
FLAG 5280 -336 24Vs
IOPIN 5280 -336 Out
FLAG -448 1312 0
FLAG 80 1056 VCC
FLAG 80 1120 VEE
FLAG -1808 304 0
FLAG -1104 0 V_ordered
IOPIN -1104 0 Out
FLAG -1440 272 0
FLAG -528 144 V_ordered
IOPIN -528 144 In
FLAG 3440 -32 PWM_OUT
IOPIN 3440 -32 Out
FLAG 272 48 Diff_Amp_OUT
IOPIN 272 48 Out
FLAG -1344 -32 VCC
FLAG -1344 32 VEE
FLAG 2528 0 PI_OUT
IOPIN 2528 0 In
FLAG 2896 -224 VCC
FLAG 4160 128 PWM_OUT
IOPIN 4160 128 In
FLAG 4368 -176 VCC
FLAG 4624 48 MOTOR_IN
IOPIN 4624 48 Out
FLAG 3440 384 RT/CT
IOPIN 3440 384 Out
FLAG 4864 2096 0
FLAG 4992 1920 V_LEM_LPF
IOPIN 4992 1920 Out
FLAG 3072 1920 V_LEM_LPF
IOPIN 3072 1920 In
FLAG 3072 2032 RT/CT
IOPIN 3072 2032 In
FLAG 3888 1904 Sum_Amp_OUT
IOPIN 3888 1904 Out
FLAG 2928 1200 Sum_Amp_OUT
IOPIN 2928 1200 In
FLAG 3280 1184 I_SENSE
IOPIN 3280 1184 Out
FLAG 2528 336 I_SENSE
IOPIN 2528 336 In
FLAG -528 32 V_FB
IOPIN -528 32 In
FLAG 304 1088 V_FB
IOPIN 304 1088 Out
FLAG -16 1104 FB_Scaler_IN
IOPIN -16 1104 In
SYMBOL AD822 -16 -16 R0
SYMATTR InstName U1
SYMBOL res -224 16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res -224 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res -64 240 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 48 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL voltage -2384 -48 R0
SYMATTR InstName V3
SYMATTR Value 15
SYMBOL LT1243 2896 32 R0
SYMATTR InstName U2
SYMBOL res 2720 48 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMBOL voltage -1808 160 R0
SYMATTR InstName V6
SYMATTR Value 5
SYMBOL npn 4304 80 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL res 4352 -80 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 4544 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL AD822 3056 1120 R0
SYMATTR InstName U3
SYMBOL res 2608 1184 R0
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL res 3104 1024 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL AD822 3600 1840 R0
SYMATTR InstName U4
SYMBOL res 3376 1904 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 1k
SYMBOL res 3376 2016 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL res 3776 1984 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100
SYMBOL res 3488 1984 R0
SYMATTR InstName R13
SYMATTR Value 100
SYMBOL LTC4449 5568 128 R0
SYMATTR InstName U5
SYMBOL nmos 6032 -32 R0
SYMATTR InstName M1
SYMATTR Value IPB011N04L
SYMBOL nmos 6032 208 R0
SYMATTR InstName M2
SYMATTR Value IPB011N04L
SYMBOL res 5968 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 39 47 VTop 2
SYMATTR InstName R14
SYMATTR Value 10
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res 5984 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL ind 6400 -256 R0
SYMATTR InstName L1
SYMATTR Value 100µ
SYMBOL res 6400 -144 R0
SYMATTR InstName R16
SYMATTR Value .05
SYMBOL schottky 5440 -64 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value SS3P5
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 5280 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value 5
SYMBOL cap 5664 -96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 0.22µ
SYMBOL battery 5824 -320 R0
WINDOW 0 -56 17 Left 2
WINDOW 3 -58 75 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V11
SYMATTR Value 24
SYMBOL polcap 5936 -288 R0
WINDOW 0 -29 9 Left 2
WINDOW 3 -62 48 Left 2
SYMATTR InstName C3
SYMATTR Value 1500µ
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=50 Irms=2.41 Rser=0.026 Lser=0 mfg="Nichicon" pn="UPL1H152MRH" type="Al electrolytic"
SYMBOL cap 6016 -288 R0
WINDOW 0 -28 3 Left 2
WINDOW 3 -46 48 Left 2
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL cap 5360 128 R0
SYMATTR InstName C5
SYMATTR Value 0.1µ
SYMATTR SpiceLine V=16 Irms=1.02 Rser=0.0850352 Lser=0 mfg="KEMET" pn="C1206F104K4RAC" type="X7R"
SYMBOL res 5968 32 R0
WINDOW 0 38 40 Left 2
WINDOW 3 43 76 Left 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res 5984 272 R0
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL bv 5888 1968 M0
SYMATTR InstName B1
SYMATTR Value V=0.00416*I(L1)+2.5
SYMBOL voltage 6416 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V12
SYMATTR Value 10
SYMBOL AD822 80 1024 R0
SYMATTR InstName U6
SYMBOL res -464 1088 R0
SYMATTR InstName R19
SYMATTR Value 1k
SYMBOL res 128 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL res -1824 32 R0
SYMATTR InstName R21
SYMBOL res -1824 -128 R0
SYMATTR InstName R22
SYMBOL AD822 -1344 -64 R0
SYMATTR InstName U7
SYMBOL res -1456 160 R0
SYMATTR InstName R23
SYMBOL res -1248 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMBOL res 3344 144 R0
SYMATTR InstName R25
SYMBOL cap 2592 432 R0
SYMATTR InstName C6
SYMBOL cap 3104 160 R0
SYMATTR InstName C7
SYMBOL res 3248 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMBOL res 3296 256 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R27
SYMBOL res 4784 1904 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMBOL cap 4848 1984 R0
SYMATTR InstName C1
TEXT -560 312 Left 2 !.tran 50
TEXT 4536 176 Left 2 !.tran 100m
TEXT 3056 2168 Left 2 !.tran 50
TEXT 5744 1736 Left 2 ;LEM
TEXT 3352 832 Left 2 ;Non-Inverting Amplifier
TEXT 3936 1664 Left 2 ;Summing Amplifier
TEXT 2816 -400 Left 2 ;PWM Chip
TEXT 4384 -392 Left 2 ;Inverter
TEXT 1488 -368 Left 2 ;PI Control
TEXT -88 -248 Left 2 ;Differential Amplifer
TEXT -1704 -280 Left 2 ;Voltage Source
TEXT 5808 -408 Left 2 ;Motor
TEXT 256 760 Left 2 ;Non-Inverting Amplifier
TEXT 4752 1736 Left 2 ;Low-Pass Filter
RECTANGLE Normal 608 400 -752 -256 2
RECTANGLE Normal 3744 688 2384 -368 2
RECTANGLE Normal 3616 1568 2528 864 2
RECTANGLE Normal 4448 2256 2560 1696 2
RECTANGLE Normal -928 400 -2784 -256 2
RECTANGLE Normal 2288 400 752 -336 2
RECTANGLE Normal 4912 416 3904 -368 2
RECTANGLE Normal 6608 464 5040 -400 2
RECTANGLE Normal 6080 2208 5408 1760 2
RECTANGLE Normal 496 1424 -624 784 2
RECTANGLE Normal 2368 2256 576 1696 2
RECTANGLE Normal 5200 2208 4528 1760 2
