Version 4
SHEET 1 7732 3076
WIRE 2544 -784 2544 -880
WIRE 1920 -720 1824 -720
WIRE 2032 -720 2000 -720
WIRE 2384 -720 2032 -720
WIRE 3008 -688 2704 -688
WIRE 3088 -688 3008 -688
WIRE 2032 -656 2032 -720
WIRE 2064 -656 2032 -656
WIRE 2192 -656 2144 -656
WIRE 2384 -656 2256 -656
WIRE 2272 -592 2256 -592
WIRE 2384 -592 2352 -592
WIRE 2848 -560 2704 -560
WIRE 2256 -528 2256 -592
WIRE 2256 -528 2096 -528
WIRE 2384 -528 2256 -528
WIRE 2256 -496 2256 -528
WIRE 3008 -496 3008 -688
WIRE 2256 -384 2256 -432
WIRE 2544 -384 2544 -464
WIRE 2544 -384 2256 -384
WIRE 2672 -384 2544 -384
WIRE 3008 -384 3008 -416
WIRE 3008 -384 2672 -384
WIRE 2672 -352 2672 -384
WIRE 3344 -336 3344 -432
WIRE 928 -288 768 -288
WIRE 6944 -288 6400 -288
WIRE 7072 -288 6944 -288
WIRE 7152 -288 7072 -288
WIRE 7200 -288 7152 -288
WIRE 7536 -288 7200 -288
WIRE 6944 -256 6944 -288
WIRE 928 -240 928 -288
WIRE 7072 -240 7072 -288
WIRE 7152 -240 7152 -288
WIRE 2528 -224 2480 -224
WIRE 2672 -224 2608 -224
WIRE 7536 -192 7536 -288
WIRE 3744 -176 3744 -240
WIRE 560 -160 560 -192
WIRE 1360 -144 1296 -144
WIRE 1552 -128 1424 -128
WIRE 1632 -128 1552 -128
WIRE 6944 -128 6944 -176
WIRE 7072 -128 7072 -176
WIRE 7072 -128 6944 -128
WIRE 7152 -128 7152 -176
WIRE 7152 -128 7072 -128
WIRE 928 -112 928 -160
WIRE 1360 -112 928 -112
WIRE 2144 -96 2048 -96
WIRE 2256 -96 2144 -96
WIRE 2480 -96 2480 -224
WIRE 2480 -96 2336 -96
WIRE 2528 -96 2480 -96
WIRE 928 -80 928 -112
WIRE 2672 -80 2672 -224
WIRE 2672 -80 2592 -80
WIRE 2848 -80 2672 -80
WIRE 7536 -80 7536 -112
WIRE 2528 -64 2496 -64
WIRE 3744 -64 3744 -96
WIRE 3824 -64 3744 -64
WIRE 4000 -64 3904 -64
WIRE 560 -48 560 -80
WIRE 672 -48 560 -48
WIRE 672 -32 672 -48
WIRE 3744 -32 3744 -64
WIRE 6400 -32 6352 -32
WIRE 6496 -32 6400 -32
WIRE 6560 -32 6496 -32
WIRE 6688 -32 6624 -32
WIRE 6720 -32 6688 -32
WIRE 6864 -32 6784 -32
WIRE 1296 0 1296 -144
WIRE 1552 0 1552 -128
WIRE 1552 0 1296 0
WIRE 2256 16 2048 16
WIRE 2496 16 2496 -64
WIRE 2496 16 2336 16
WIRE 3584 16 3536 16
WIRE 3680 16 3664 16
WIRE 6400 16 6400 -32
WIRE 7200 16 7200 -288
WIRE 6688 32 6688 -32
WIRE 928 48 928 0
WIRE 7536 64 7536 0
WIRE 560 96 560 -48
WIRE 6496 96 6496 -32
WIRE 6560 96 6496 96
WIRE 6992 96 6816 96
WIRE 7104 96 7072 96
WIRE 7152 96 7104 96
WIRE 2496 112 2496 96
WIRE 3744 128 3744 64
WIRE 768 144 768 -288
WIRE 928 144 928 128
WIRE 928 144 768 144
WIRE 928 176 928 144
WIRE 6496 176 6496 96
WIRE 6560 176 6496 176
WIRE 6864 176 6864 -32
WIRE 6864 176 6816 176
WIRE 7104 176 6864 176
WIRE 7200 176 7200 112
WIRE 7200 176 7104 176
WIRE 7536 176 7536 144
WIRE 7536 176 7200 176
WIRE 6560 256 6352 256
WIRE 6928 256 6816 256
WIRE 7200 256 7200 176
WIRE 1840 336 1696 336
WIRE 6928 336 6928 256
WIRE 7008 336 6928 336
WIRE 7120 336 7088 336
WIRE 7152 336 7120 336
WIRE 1312 368 1120 368
WIRE 6400 368 6400 96
WIRE 6496 368 6496 240
WIRE 6496 368 6400 368
WIRE 6688 368 6688 320
WIRE 6688 368 6496 368
WIRE 1696 400 1696 336
WIRE 1728 400 1696 400
WIRE 6688 400 6688 368
WIRE 1312 416 1312 368
WIRE 1840 416 1840 336
WIRE 1840 416 1792 416
WIRE 1856 416 1840 416
WIRE 2032 416 1936 416
WIRE 2160 416 2032 416
WIRE 3424 432 3296 432
WIRE 7120 432 7120 416
WIRE 7200 432 7200 352
WIRE 7200 432 7120 432
WIRE 7200 448 7200 432
WIRE 2032 480 2032 416
WIRE 2032 592 2032 544
WIRE 496 704 352 704
WIRE 3424 736 3312 736
WIRE 3600 736 3504 736
WIRE 3776 736 3600 736
WIRE 1712 752 1568 752
WIRE 352 768 352 704
WIRE 384 768 352 768
WIRE 624 768 592 768
WIRE 800 768 704 768
WIRE 928 768 800 768
WIRE 3600 768 3600 736
WIRE 496 784 496 704
WIRE 496 784 448 784
WIRE 592 784 592 768
WIRE 592 784 496 784
WIRE 384 800 272 800
WIRE 2160 800 2096 800
WIRE 1520 816 1392 816
WIRE 1568 816 1568 752
WIRE 1600 816 1568 816
WIRE 2400 816 2224 816
WIRE 2816 816 2400 816
WIRE 800 832 800 768
WIRE 1712 832 1712 752
WIRE 1712 832 1664 832
WIRE 1872 832 1712 832
WIRE 2048 832 1952 832
WIRE 2160 832 2128 832
WIRE 1520 848 1520 816
WIRE 1600 848 1520 848
WIRE 2048 896 2048 832
WIRE 2128 896 2128 832
WIRE 2128 896 2048 896
WIRE 3600 896 3600 848
WIRE 2096 912 2096 800
WIRE 2272 912 2096 912
WIRE 2400 912 2400 816
WIRE 2400 912 2352 912
WIRE 800 944 800 896
WIRE 1872 944 1664 944
WIRE 2048 944 2048 896
WIRE 2048 944 1952 944
WIRE 2096 1024 2096 992
WIRE 2096 1024 1904 1024
WIRE 1904 1056 1904 1024
FLAG 2496 192 0
FLAG 2560 -112 VCC
FLAG 2560 -48 VEE
FLAG 672 -32 0
FLAG 560 -192 VCC
FLAG 560 96 VEE
FLAG 2144 -96 VIN
FLAG 2672 -352 0
FLAG 3744 128 0
FLAG 1904 1056 0
FLAG 2192 784 VCC
FLAG 2192 848 VEE
FLAG 7200 448 0
FLAG 6688 400 0
FLAG 6944 -128 0
FLAG 6352 -32 5Vs
IOPIN 6352 -32 Out
FLAG 1120 368 V_LEM
IOPIN 1120 368 Out
FLAG 272 800 V_LEM
IOPIN 272 800 In
FLAG 1312 496 0
FLAG 6352 256 PWM
IOPIN 6352 256 In
FLAG 5456 896 5Vs
IOPIN 5456 896 Out
FLAG 6400 -288 24Vs
IOPIN 6400 -288 Out
FLAG 928 176 0
FLAG 1632 -128 V_ordered
IOPIN 1632 -128 Out
FLAG 2048 16 V_ordered
IOPIN 2048 16 In
FLAG 3088 -688 PWM_OUT
IOPIN 3088 -688 In
FLAG 2848 -80 Diff_Amp_OUT
IOPIN 2848 -80 Out
FLAG 1392 -160 VCC
FLAG 1392 -96 VEE
FLAG 1824 -720 Diff_Amp_OUT
IOPIN 1824 -720 In
FLAG 2544 -880 VCC
FLAG 3536 16 PWM_OUT
IOPIN 3536 16 In
FLAG 3744 -240 VCC
IOPIN 3744 -240 In
FLAG 4000 -64 MOTOR_IN
IOPIN 4000 -64 Out
FLAG 2096 -528 RT/CT
IOPIN 2096 -528 Out
FLAG 800 944 0
FLAG 928 768 V_LEM_LPF
IOPIN 928 768 Out
FLAG 1392 816 V_LEM_LPF
IOPIN 1392 816 In
FLAG 1664 944 RT/CT
IOPIN 1664 944 In
FLAG 2816 816 Sum_Amp_OUT
IOPIN 2816 816 Out
FLAG 3312 736 Sum_Amp_OUT
IOPIN 3312 736 In
FLAG 3776 736 I_SENSE
IOPIN 3776 736 Out
FLAG 2848 -560 I_SENSE
IOPIN 2848 -560 In
FLAG 2048 -96 V_FB
IOPIN 2048 -96 In
FLAG 3424 432 V_FB
IOPIN 3424 432 Out
FLAG 3296 432 FB_Scaler_IN
IOPIN 3296 432 In
FLAG 1728 432 V_LEM
IOPIN 1728 432 In
FLAG 2032 592 0
FLAG 2160 416 FB_Scaler_IN
IOPIN 2160 416 Out
FLAG 3344 -336 0
FLAG 3344 -512 PWM
IOPIN 3344 -512 Out
FLAG 3600 896 0
FLAG 416 752 VCC
FLAG 416 816 VEE
FLAG 1632 800 VCC
FLAG 1632 864 VEE
FLAG 1760 384 VCC
FLAG 1760 448 VEE
SYMBOL AD822 2560 -144 R0
SYMATTR InstName U1
SYMBOL res 2352 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 5k
SYMBOL res 2352 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 5k
SYMBOL res 2512 112 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 5k
SYMBOL res 2624 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 5k
SYMBOL voltage 560 -176 R0
SYMATTR InstName V3
SYMATTR Value 15
SYMBOL LT1243 2544 -624 R0
SYMATTR InstName U2
SYMBOL res 2368 -608 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL voltage 928 32 R0
SYMATTR InstName V6
SYMATTR Value 5
SYMBOL npn 3680 -32 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL res 3728 -192 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 3920 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 12k
SYMBOL AD822 2192 752 R0
SYMATTR InstName U4
SYMBOL res 1968 816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 3k
SYMBOL res 1968 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 12k
SYMBOL res 2368 896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL res 2080 896 R0
SYMATTR InstName R13
SYMATTR Value 1Meg
SYMBOL LTC4449 6688 176 R0
SYMATTR InstName U5
SYMBOL nmos 7152 16 R0
SYMATTR InstName M1
SYMATTR Value IPB011N04L
SYMBOL nmos 7152 256 R0
SYMATTR InstName M2
SYMATTR Value IPB011N04L
SYMBOL res 7088 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 39 47 VTop 2
SYMATTR InstName R14
SYMATTR Value 10
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res 7104 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL ind 7520 -208 R0
SYMATTR InstName L1
SYMATTR Value 100µ
SYMBOL res 7520 -96 R0
SYMATTR InstName R16
SYMATTR Value .05
SYMBOL schottky 6560 -16 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value SS3P5
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL voltage 6400 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value 5
SYMBOL cap 6784 -48 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 0.22µ
SYMBOL battery 6944 -272 R0
WINDOW 0 -56 17 Left 2
WINDOW 3 -58 75 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V11
SYMATTR Value 24
SYMBOL polcap 7056 -240 R0
WINDOW 0 -29 9 Left 2
WINDOW 3 -62 48 Left 2
SYMATTR InstName C3
SYMATTR Value 1500µ
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=50 Irms=2.41 Rser=0.026 Lser=0 mfg="Nichicon" pn="UPL1H152MRH" type="Al electrolytic"
SYMBOL cap 7136 -240 R0
WINDOW 0 -28 3 Left 2
WINDOW 3 -46 48 Left 2
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL cap 6480 176 R0
SYMATTR InstName C5
SYMATTR Value 0.1µ
SYMATTR SpiceLine V=16 Irms=1.02 Rser=0.0850352 Lser=0 mfg="KEMET" pn="C1206F104K4RAC" type="X7R"
SYMBOL res 7088 80 R0
WINDOW 0 38 40 Left 2
WINDOW 3 43 76 Left 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res 7104 320 R0
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL bv 1312 400 M0
SYMATTR InstName B1
SYMATTR Value V=0.00416*I(L1)+2.5
SYMBOL voltage 7536 48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V12
SYMATTR Value 10
SYMBOL res 912 -96 R0
SYMATTR InstName R21
SYMATTR Value 5k
SYMBOL res 912 -256 R0
SYMATTR InstName R22
SYMATTR Value 5k
SYMBOL AD822 1392 -192 R0
SYMATTR InstName U7
SYMBOL cap 2240 -496 R0
SYMATTR InstName C6
SYMATTR Value 47n
SYMBOL res 720 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 120
SYMBOL cap 784 832 R0
SYMATTR InstName C1
SYMATTR Value 1.5n
SYMBOL res 1952 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 12k
SYMBOL cap 2016 480 R0
SYMATTR InstName C9
SYMATTR Value 150n
SYMBOL res 3680 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R35
SYMATTR Value 12k
SYMBOL voltage 3344 -528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 15 0 0 0 150u 200u)
SYMBOL res 2160 -672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 12k
SYMBOL cap 2256 -672 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value 47n
SYMBOL res 2016 -736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 12k
SYMBOL voltage 2496 96 R0
SYMATTR InstName V2
SYMATTR Value 2.5
SYMBOL res 3584 752 R0
SYMATTR InstName R8
SYMATTR Value 12k
SYMBOL res 3520 720 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 56k
SYMBOL AD822 416 720 R0
SYMATTR InstName U3
SYMBOL AD822 1632 768 R0
SYMATTR InstName U6
SYMBOL AD822 1760 352 R0
SYMATTR InstName U8
TEXT 1560 200 Left 2 !.tran 0.1
TEXT 1680 232 Left 2 ;LEM
TEXT 3288 -96 Left 2 ;Inverting Amplifier
TEXT 2672 720 Left 2 ;Summing Amplifier
TEXT 3560 -944 Left 2 ;PWM Chip
TEXT 3520 -88 Left 2 ;Inverter
TEXT 1936 -184 Left 2 ;Differential Amplifer
TEXT 576 200 Left 2 ;Voltage Source
TEXT 6928 -360 Left 2 ;Motor
TEXT 3456 560 Left 2 ;Non-Inverting Amplifier
TEXT 536 920 Left 2 ;Low-Pass Filter
TEXT 2360 376 Left 2 ;AC block Low Pass Filter
RECTANGLE Normal 3184 240 1792 -304 2
RECTANGLE Normal 3744 -320 1552 -944 2
RECTANGLE Normal 4176 1088 3088 688 2
RECTANGLE Normal 3056 1088 1184 688 2
RECTANGLE Normal 1808 240 416 -304 2
RECTANGLE Normal 4256 240 3168 -304 2
RECTANGLE Normal 7728 512 6160 -352 2
RECTANGLE Normal 1504 640 816 256 2
RECTANGLE Normal 3792 672 2672 256 2
RECTANGLE Normal 2672 672 1504 256 2
RECTANGLE Normal 1136 1056 16 656 2
